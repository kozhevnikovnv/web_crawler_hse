<!DOCTYPE html>
<html lang="en">
<head>
<title>Пользователи и их права доступа</title>
<meta charset="utf-8"/>
<link href="/assets/css/main.css" rel="stylesheet"/>
<meta content="width=device-width, initial-scale=1, viewport-fit=cover" name="viewport"/>
<link href="/assets/shower/themes/ribbon/styles/styles.css" rel="stylesheet"/>
<style>
        .shower {
            --slide-ratio: calc(16 / 12);
        }
    </style>
<style>

        html{
            background-color: #000;
        }

        body{
            min-height: 0;
            background-color: #000;
        }

        #cover h2 {
            margin: 30px 0 0;
            /*color: white;*/
            text-align: center;
            font-size: 70px;
        }

        #cover p {
            margin: 10px 0 0;
            text-align: center;
            color: white;
            font-style: italic;
            font-size: 12px;
        }

        #cover p a {
            /*color: white;*/
        }

        #temp {
            display: none;
            visibility: hidden;
        }

        section {
            font-size: 20px;
        }

        section h2 {
            font-size: 50px;
        }

        .slide{
            line-height: 1.2em;
            font-size: 1em;
        }

        .slide ol, .slide ul {
            line-height: 1em;
        }

        .slide pre {
            overflow-x: hidden; 
            overflow-y: hidden; 
            line-height: 1.2em;
            /*font-size: 1em;*/
        }

        img {
            max-height: 550px;
            width: auto;
        }

        img#cover{
            height: 100%;
            width: auto;
        }

        .slide .shout {
            font-size: 120px;
        }

        .mjx-chtml{
        	font-size: 25px !important;
        }

        section > div.presentation, section > img{
		  margin: 0;
		  position: absolute;
		  top: 460px;
		  left: 50%;
		  -ms-transform: translate(-50%, -50%);
		  transform: translate(-50%, -50%);
		}
    </style>
<script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript">
</script>
<script type="text/x-mathjax-config">
	   MathJax.Hub.Config({
	     extensions: ["tex2jax.js"],
	     jax: ["input/TeX", "output/HTML-CSS"],
	     tex2jax: {
	       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
	       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
	       processEscapes: true
	     },
	     "HTML-CSS": { availableFonts: ["TeX"] }
	   });
	</script>
</head>
<body class="shower list">
<div id="temp">
<h3 id="зачем-нужно-разделение-доступа">Зачем нужно разделение доступа?</h3>
<p>Современные операционные системы рассчитаны на использование многими пользователями одновременно. Раньше такое разделение использовалось когда компьютеры были слишком дорогими, чтобы обеспечивать ими всех работников и несколько человек могли по сети подключиться к одной рабочей станции, чтобы работать с ней.</p>
<p>При работе нескольких пользователей за одной машиной необходимо разделить их полномочия. Во-первых, пользователи не должны иметь право вмешиваться в работу системы в целом. Например, если один пользователь захочет удалить установленную в системе программу, это может затронуть работу других пользователей, которые эту программу используют. Во-вторых, пользователи должны сами решать, показывать ли свои файлы и папки другим пользователям.</p>
<p>Естественно, должны существовать пользователи с расширенным набором полномочий, которые могут осуществлять обслуживание системы в целом. Обычно это системные администраторы, которые ответственны за техническое состояние системы. Обычно они же управляют полномочиями пользователей: определяют, что могут, а чего не могут делать рядовые пользователи.</p>
<p>Сейчас, в эру персональных компьютеров когда за Вашим личным компьютером вряд ли работает много малознакомых человек, многопользовательская работа используется для двух основных сценариев:</p>
<ol>
<li>Если мы говорим о пользовательских устройствах, то часто пользователи используются для разделения доступа между приложениями. Например, в ОС Android для каждого установленного приложения регистрируется новый пользователь. Таким образом, одно приложение не может вмешаться в работу другого и в работу системы в целом.</li>
<li>На серверных компьютерах все еще зачастую работают несколько человек, как системных администраторов, так и неограниченный круг пользователей, которые могут подключаться к серверу по сети и иметь доступ к некоторым данным и сервисам этого сервера. Даже на ваш персональный компьютер могут подключиться пользователи и процессы по сети и им необходимо как-то ограничить возможность действий в операционной системе.</li>
</ol>
<p>В любом случае, речь идет о разграничении доступа пользователей к ресурсам операционной системы. Под ресурсом здесь понимается любая информация, аппаратные компоненты, программы, то есть все, чем можно воспользоваться при работе за компьютером. В операционной системе Linux любые информационные ресурсы представляются в виде файла. Это позволяет иметь один механизм разделению доступа - по файлам, вместо того, чтобы отдельно ограничивать доступ к аппаратным компонентам, сети, программам и так далее.</p>
<p>Любой пользователь компьютера в такой системе имеет определенные права - что-то он может делать, а что-то сама операционная система ему запретит. В Linux, так как все представляется в виде файла это выражается в том, что к каким-то файлам у пользователя есть доступ, а к каким-то нет, или он ограничен. Причем при проектировании операционных систем гораздо безопаснее и надежнее исходить их принципа минимальных прав - это когда пользователю разрешается только то, что ему необходимо делать, а все остальное - запрещается. Другими словами, все, что не разрешено явно и специально - запрещено по умолчанию. При таком подходе пользователь не сможет своими действиями нанести вред всей системе, умышленно или случайно.</p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>Современные компьютеры могут использоваться несколькими пользователями одновременно.</li>
<li>Поэтому должно быть разделение и ограничение доступа к ресурсам.</li>
<li>Ресурсы - это файлы, устройства, сеть. В Linux - это все файлы.</li>
<li>Пользователи могут применяться для разделения доступа между приложениями.</li>
<li>Каждый пользователь имеет свои полномочия в системе - права доступа.</li>
<li>Необходимо придерживаться принципа минимальных прав.</li>
</ol>
</div>
<h3 id="что-такое-пользователь">Что такое пользователь?</h3>
<p style="text-align: center; font-size:0.7em;"><img alt="Пользователь" class="align-center" src="/assets/images/os_text/os13-0.png" style="width: 800px;" title="Пользователь"/></p>
<p>Для того, чтобы система разделения прав доступа работала, операционная система должна знать две вещи: во-первых, какие пользователи вообще существуют и каким из них является данный пользователь. Первое - это регистрация, а второе - авторизация. В первую очередь, операционная система должна хранить информацию о том, какие пользователи ей знакомы, и какими правами обладает каждый из них. Запись о пользователе в операционной системе называется учетной записью. При установке системы создается учетная запись администратора системы, могут быть созданы запись других пользователей. Администратор может потом создавать, удалять или редактировать учетные записи пользователей.</p>
<p>Для начала работы с операционной системой человек должен пройти процедуру авторизации - сопоставления пользователя одной из учетных записей, хранящихся в системе.</p>
<p>Авторизация обычно построена на вводе в систему одного из возможных секретов:</p>
<ol>
<li>То, что пользователь знает - авторизация по паролю или ключевой фразе. Это технически самый простой вид авторизации до сих пор широко распространен.</li>
<li>То, что пользователь имеет - физический ключ, содержащий электронный криптографический сертификат. Это развитие предыдущего способа, когда конкретный секрет скрыт для безопасности от пользователя и воплощен в какой-то физической форме.</li>
<li>То, чем пользователь является - биометрическая аутентификация. Еще недавно этот способ был очень дорогим из-за нераспространенности специализированного оборудования. Сейчас он используется все чаще, так как биометрические датчики встроены во многие смартфоны. Очень часто он используется в сочетании с другими способами (двухфакторная аутентификация).</li>
</ol>
<p>В настоящее время наиболее распространена авторизация по паролю - это самый технически простой и потенциально надежный способ. В последнее время все больше распространяются способы биометрической авторизации, более сложные способы - например, двухфакторная аутентификация которая основана на авторизации на другом доверенном устройстве. Но в любом случае, авторизация - это доказательство, что вы действительно являетесь тем пользователем, который заявляется. В случае авторизации по паролю пользователь должен ввести логин (имя пользователя) и пароль. Если пароль не соответствует тому, что содержится в учетной запись данного пользователя в конфигурации операционной системы, то она откажет пользователю в работе.</p>
<p>Если же авторизация проша успешно, операционная система запускает программу-оболочку. Это может быть текстовый командный интерпретатор, либо графический оконный менеджер, в зависимости от настроек и комплекта поставки системы. Но в любом случае, далее приводится в действие важный принцип, без которого невозможно надежное функционирование операционных систем и разделения доступа - все действия, которые пользователь выполняет, операционная система отслеживает и проверяет на права доступа. То есть пользователь не сможет получить доступ ни к чему, чтобы ему не было разрешено операционной системой. Более того, любая программа, команда, процесс, который запускает этот пользователь, будет работать с его правами.</p>
<p>Эта система работает за счет двух фактов: во-первых, пользователь не может получить доступ ни к каким ресурсам компьютера напрямую, только через операционную систему. Например, пользователь (или, что то же самое, программа, запущенная пользователем) не может напрямую открыть файл. Пользователь может лишь попросить операционную систему открыть файл и дать ему содержимое этого файла. Обычно, это происходит быстро и прозрачно, так что создается впечатление, что сам пользователь открывает файл. И во-вторых, система проверки прав доступа “зашита” в сам фундамент операционной системы, в ее ядро. Это не позволяет обойти систему прав доступа. Каждый раз когда нужно обратиться к какому-то компьютерному ресурсу, пользователь вынужден просить об этом операционную систему, а она, в свою очередь, каждый раз проверяет, что за пользователь пытается выполнить это действие и имеет ли он на это право.</p>
<p>Кстати, мы обычно подразумеваем, что пользователь - это человек, который работает за компьютером. Но с точки зрения операционной системы пользователь - это учетная запись, обладающая определенными правами. Человек может авторизоваться как определенный пользователь. А потом, в процессе работы, он может авторизоваться как другой пользователь, то есть сменить учетную запись. Так что лучше считать, что пользователь - это определенная роль при работе с операционной системой. Не обязательно создавать строго по одному пользователю на каждого человека, который работает за компьютером. Иногда удобнее создать пользователя в определенными правами для выполнения конкретных действий, или для работы с определенной программой. Такие пользователи иногда называются служебными. И в любой операционной системе служебных пользователей гораздо больше, чем “реальных”.</p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>Пользователь для ОС - это учетная запись с именем и способом авторизации.</li>
<li>Первоначальная регистрация пользователей происходит при установке операционной системы.</li>
<li>Обычно применяется авторизацию по паролю.</li>
<li>Для начала работы в системе необходимо залогиниться - пройти авторизацию.</li>
<li>Все процессы, которые запускает пользователь выполняются от его имени и с его правами.</li>
<li>Система авторизации и разграничения пользователей встроена в само ядро операционной системы.</li>
<li>Существуют служебные пользователи - они не люди, а роли при работе, которые нужны для удобства.</li>
</ol>
</div>
<h3 id="где-хранится-информация-о-пользователях">Где хранится информация о пользователях?</h3>
<p style="text-align: center; font-size:0.7em;"><img alt="Файл /etc/passwd" class="align-center" src="/assets/images/os_text/os13-1.png" style="width: 800px;" title="Файл /etc/passwd"/></p>
<p>В любой операционной системе хранится информация о том, какие пользователи в ней зарегистрированы и могут авторизоваться для работы с ней. В Linux эта информация хранится в файле /etc/passwd. Это простой текстовый файл, как и большинство других конфигурационных файлов Linux. Его можно открыть и отредактировать любым текстовым редактором или командами работы с текстом терминала. Этот файл доступен для просмотра любому авторизованному пользователю, но редактировать его может только администратор системы.</p>
<p>Файл /etc/passwd представляет собой табличную структуру - каждая строка в нем соответствует одному пользователю, а в строке содержатся несколько полей, значения которых разделяются двоеточиями. Это типичная структура конфигурационного файла Linux. Надо отметить, что этот файл - это не просто отображение информации о пользователях, он и представляет собой настройку операционной системы. Она сама берет информацию о своих пользователях из этого файла. Поэтому, если этот файл отредактировать, например, добавить в него новую строку, это будет эквивалентно регистрации нового пользователя.</p>
<p>Любой пользователь Linux должен иметь имя - строку, которая однозначно характеризует пользователя (то есть не повторяется) и отображается во всех сообщениях системы. Имя пользователя состоит из строчных латинских букв и может содержать знаки подчеркивания. Имя пользователя так же указывается при авторизации пользователей в системе.</p>
<p>Кроме символьного имени, каждому пользователю автоматически присваивается численный идентификатор. Операционной системе проще работать с числами, чем со строками, поэтому этот идентификатор, называемый UID (user identifier), используется внутри системы. Например, именно он отслеживается у всех запущенных процессов. Обычно, в современных дистрибутивах Linux идентификаторы пользователей, которые были вручную созданы при установке или настройке системы начинаются с 1000. Номера меньше 1000 зарезервированы для служебных пользователей, которые создаются автоматически разными программами.</p>
<p>Кроме имени и идентификатора для авторизации пользователя нужен пароль. Раньше пароль указывался тут же, в файле /etc/passwd, вместе со всей остальной информацией о пользователе. Но по соображениям удобства, нужно, чтобы этот файл был доступен на чтение всем пользователям системы. Это нужно для организации процесса аутентификации. А если любой пользователь может прочитать этот файл, значит в нем нельзя хранить пароли. Поэтому сейчас вы не увидите паролей в файле /etc/passwd, на их месте стоит символ “х”. Сами пароли (а вернее их хеши) хранятся в другом файле - /etc/shadow, который доступен для чтения только администратору системы.</p>
<p>Еще в файле /etc/passwd для каждого пользователя указывается адрес домашней папки. Этот адрес подставляется вместо символа ~ в путях, а также в некоторых других сокращениях команд терминала. Домашняя папка пользователя предназначена для хранения файлов этого пользователя. У любого пользователя, естественно, есть полный доступ к этой папке. То есть он может создавать, удалять там папки, файлы, организовывать любой иерархию директорий. А вот к системным папкам у пользователя может быть только ограниченный доступ - на чтения, или вообще никакого. Так же в домашней папке пользователя могут храниться конфигурационные файлы, содержащие настройки системы или отдельных программ, относящиеся только к этому пользователю.</p>
<p>Обычно, при регистрации нового пользователя, его домашняя папка создается автоматически в папке /home/. И называется домашняя папка так же, как и сам пользователь. То есть у пользователя user домашняя папка по умолчанию будет /home/user. Но это можно изменить в конфигурационном файле или в команде создания пользователя. Обратите внимание, что сама папка /home/ не является домашней, и принадлежит администратору. То есть сам пользователь не сможет иметь к ней полного доступа.</p>
<p>Кстати, служебным пользователям, которые создаются автоматически и не соответствуют живому человеку, работающему за компьютером, домашние папки обычно не нужны. В таком случае, создание домашней папки можно пропустить, а в файле /etc/passwd будет просто пропуск.</p>
<p>И в последнем поле файла /etc/passwd хранится команда, которая автоматически запускается после авторизации данного пользователя в систему. Обычно, это интерпретатор командной строки /bin/bash. Именно из-за этого поведения после авторизации мы обычно видим интерфейс командной строки. Но имейте в виду, что у разных пользователей может быть установлены разные командные интерпретаторы по умолчанию. Bash - это всего лишь самый распространенный из них.</p>
<p>Еще при создании пользователя можно справочно установить некоторые необязательные поля - полное имя, номер кабинета, телефона. В настоящее время они практически никогда не используются и остаются пустыми.</p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>В Linux информация о всех пользователях хранится в файле /etc/passwd.</li>
<li>Изначально он хранил пароли, но их давно оттуда убрали для безопасности и удобства.</li>
<li>У каждого пользователя есть идентификатор - UID.</li>
<li>У каждого пользователя есть символьное имя - логин.</li>
<li>У пользователя может быть задан пароль на вход в систему.</li>
<li>У пользователя может быть домашняя папка, интерпретатор по умолчанию.</li>
<li>Еще можно задать много дополнительной информации - номер кабинета, телефона.</li>
</ol>
</div>
<h3 id="зачем-нужны-группы">Зачем нужны группы?</h3>
<p style="text-align: center; font-size:0.7em;"><img alt="Файл /etc/group" class="align-center" src="/assets/images/os_text/os13-2.png" style="width: 800px;" title="Файл /etc/group"/></p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>Группы были придуманы для удобства назначения прав доступа нескольким пользователям.</li>
<li>В настоящее время группы используются не очень часто.</li>
<li>Гораздо чаще создается специальный пользователь с нужными правами.</li>
<li>Любой пользователь может быть членом одной или нескольких групп.</li>
<li>Информация о группах хранится в файле /etc/group.</li>
<li>При создании пользователя автоматически создается группа с таким же именем.</li>
<li>Существует группа sudoers или sudousers - только ее члены могут использовать sudo.</li>
</ol>
</div>
<h3 id="что-такое-суперпользователь">Что такое суперпользователь?</h3>
<p style="text-align: center; font-size:0.7em;"><img alt="Файл /etc/group" class="align-center" src="/assets/images/os_text/os13-4.png" style="width: 800px;" title="Файл /etc/group"/></p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>Обычные пользовательские учетные записи сильно ограничены в правах.</li>
<li>Иногда необходимо произвести действия, оказывающие влияние на всю систему.</li>
<li>Для этого есть специальная учетная запись администратора - root.</li>
<li>Во всех Linux-системах существует пользователь root с идентификатором 0.</li>
<li>Именно под учетной записью администратора нужно выполнять общесистемные действия: настройка, установка и удаление программ, добавление пользователей.</li>
<li>Постоянно работать под учетной записью root категорически не рекомендуется, лучше иметь обычную учетку.</li>
<li>Чтобы каждый раз не перелогиниваться для выполнения администраторских команд, есть специальная команда sudo.</li>
<li>Командой sudo надо пользоваться с осторожностью, так как такие команды могут повредить работу операционной системы.</li>
</ol>
</div>
<h3 id="какие-основные-действия-с-пользователями-и-группами">Какие основные действия с пользователями и группами?</h3>
<p style="text-align: center; font-size:0.7em;"><img alt="Файл /etc/group" class="align-center" src="/assets/images/os_text/os13-3.png" style="width: 800px;" title="Файл /etc/group"/></p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>Команда useradd регистрирует нового пользователя в систему и все.</li>
<li>Команда adduser более полная - создает пользователя, домашнюю папку, задает ему пароль.</li>
<li>Команда userdel позволяет удалить пользователя.</li>
<li>Команда passwd используется для изменения пароля пользователя.</li>
<li>Пользователь может изменить свой пароль, суперпользователь может сменить пароль кому угодно.</li>
<li>Команда usermod может изменить параметры пользователя.</li>
<li>usermod -a -G добавляет пользователя в группу.</li>
</ol>
</div>
<h3 id="что-такое-права-доступа">Что такое права доступа?</h3>
<p style="text-align: center; font-size:0.7em;"><img alt="Файл /etc/group" class="align-center" src="/assets/images/os_text/os13-5.png" style="width: 800px;" title="Файл /etc/group"/></p>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>У каждого файла есть владелец и группа-владелец, которые задаются при создании файла.</li>
<li>По отношению к файлу пользователь может быть владельцем, членом группы или никем.</li>
<li>Права доступа к файлу задаются для каждой из этих трех категории пользователей.</li>
<li>Существует три базовых права доступа - на чтение, запись и выполнение.</li>
<li>Девять базовых прав доступа отображаются в атрибутах файла командой ls -l.</li>
<li>Для каталогов права доступа имеют свой смысл: чтение списка файлов, создание и удаление файлов и переход в эту папку соответственно.</li>
</ol>
</div>
<h3 id="как-задавать-права-доступа">Как задавать права доступа?</h3>
<div class="presentation">
<table>
<thead>
<tr>
<th>OCT</th>
<th>BIN</th>
<th>Mask</th>
<th>Права на файл</th>
<th>Права на каталог</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>000</td>
<td>- - -</td>
<td>отсутствие прав</td>
<td>отсутствие прав</td>
</tr>
<tr>
<td>1</td>
<td>001</td>
<td>- - x</td>
<td>запуск на выполнение</td>
<td>доступ к файлам и их атрибутам</td>
</tr>
<tr>
<td>2</td>
<td>010</td>
<td>- w -</td>
<td>изменение содержимого</td>
<td>создание и удаление файлов</td>
</tr>
<tr>
<td>3</td>
<td>011</td>
<td>- w x</td>
<td>права на запись и выполнение</td>
<td>все, кроме доступа к именам файлов</td>
</tr>
<tr>
<td>4</td>
<td>100</td>
<td>r - -</td>
<td>чтение содержимого</td>
<td>только чтение имен файлов</td>
</tr>
<tr>
<td>5</td>
<td>101</td>
<td>r - x</td>
<td>права на чтение и выполнение</td>
<td>чтение имен файлов и доступ файлам и их атрибутам</td>
</tr>
<tr>
<td>6</td>
<td>110</td>
<td>r w -</td>
<td>права на чтение и запись</td>
<td>только чтение имен файлов</td>
</tr>
<tr>
<td>7</td>
<td>111</td>
<td>r w x</td>
<td>полные права</td>
<td>все права</td>
</tr>
</tbody>
</table>
</div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nb">sudo chown </span>new_owner:new_group file1 file2 …
hmod 755 file
<span class="nb">chmod </span>u+w file
<span class="nb">chmod </span>go-rw file_name
<span class="nb">chmod </span>ugo+rwx file_name
<span class="nb">chmod</span> +x file_name
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="notice--info">
<p>Выводы:</p>
<ol>
<li>Новые файлы получают стандартные права доступа, заданные командой umask.</li>
<li>Можно изменить владельца и группу файла командой chown.</li>
<li>Права доступа к файлу может изменить владелец или рут командой chmod.</li>
<li>Права доступа задаются в символьном или в восьмеричном выражении.</li>
<li>Можно задать специальные биты прав доступа - SUID, SGID и Sticky-bit.</li>
</ol>
</div>
</div>
<header class="caption">
<h1>Пользователи и их права доступа</h1>
<!-- <p>Yours Truly, Famous Inc.</p> -->
</header>
<section class="slide">
<h2 class="shout">Пользователи и их права доступа</h2>
</section>
<footer class="badge">
<a href="https://github.com/shower/shower">Build with shower</a>
</footer>
<script src="/assets/shower/shower.js"></script>
<!-- Copyright © 3000 Yours Truly, Famous Inc. -->
<script type="text/javascript">
        
        const content = document.querySelector('#temp');
        const childern = content.childNodes;

        let current_slide;
        let points;
        let code;
        let image;
        let misc;

        function commit() {
            if (current_slide) {

                const elems = [image, code, points, misc];

                let slide;

                elems.forEach(elem => {
                    if (elem) {
                        // console.log("ИТЕРАЦИЯ " + current_slide);
                        // console.log([image, code, points, misc]);

                        slide = document.createElement('section');
                        slide.className = "slide";
                        let slide_header = document.createElement('h2');
                        slide_header.innerHTML = current_slide;
                        slide.appendChild(slide_header);

                        slide.appendChild(elem);

                        document.body.appendChild(slide);

                        fit_in_slide(elem);
                    }
                });

                misc = undefined;
                points = undefined;
                image = undefined;
                code = undefined;
            }
        }

        function fit_in_slide(element) {
            console.log("ИТЕРАЦИЯ " + current_slide);
            console.log(element);

            let ratio = Math.min(
            	550 / element.offsetHeight,
            	// 1600 / element.offsetWidth,
            	);


            let new_size = Math.sqrt(ratio) / 1.2;
            if (new_size > 2.5) {
                new_size = 2.5
            }
            element.style["font-size"] = new_size + "em";

            new_size = Math.pow(ratio, 1.1) * 12;
            if (new_size > 30) {
                new_size = 30
            }

            ratio = Math.min(
            	550 / element.offsetHeight,
            	1600 / element.offsetWidth,
            	);

            new_size = Math.pow(ratio, 1.1) * 12;
            if (new_size > 30) {
                new_size = 30
            }

            console.log(element.innerHTML);            
            console.log(element.querySelectorAll("*"));            
            console.log(element.querySelectorAll("pre"));

            element.querySelectorAll("pre").forEach(e => {
                e.style["font-size"] = new_size + "px";
                e.style["line-height"] = new_size * 1.2 + "px";
            });

            element.querySelectorAll("span").forEach(e => {
            	console.log("found");
                e.style["font-size"] = new_size + "px";
                e.style["line-height"] = new_size * 1.2 + "px";
            });

            console.log(
                // realHeight, ratio, 
                new_size, 
                element.offsetHeight,
                element.offsetWidth);

            return element;
        }

        childern.forEach(elem => {
            if (elem.tagName == "H3") {
                commit();
                let slide = document.createElement('section');
                slide.className = "slide";
                let slide_header = document.createElement('h2');
                slide_header.className = "shout shrink"
                slide_header.innerHTML = elem.innerHTML;
                slide.appendChild(slide_header);

                // slide.appendChild(elem);

                document.body.appendChild(slide);
            }

            if (elem.tagName == "H3" || elem.tagName == "H4") {
                commit();
                current_slide = elem.innerHTML;
            }

            else if (elem.tagName == "DIV" && elem.classList.contains("notice--info")) {
                let list = elem.getElementsByTagName('ol')[0];

                list.childNodes.forEach(elem => {
                    elem.className = "next";
                });

                points = list;
                // points = fit_in_slide(points);
            } 

            else if (elem.tagName == "DIV" && elem.classList.contains("highlighter-rouge")) {
                code = elem;
                commit()
                // code = fit_in_slide(code);
            } 

            else if (elem.tagName == "DIV" && elem.classList.contains("presentation")) {
                misc = elem;
                // misc = fit_in_slide(misc);
                commit();
            } 

            else if (elem.tagName == "P" && elem.getElementsByTagName('img').length > 0) {
                image = elem.getElementsByTagName('img')[0];
                image.style.width = "auto";
                commit();
            } 
        });

        commit();

        content.remove();

    </script>
<div class="progress"></div>
<script src="/assets/js/main.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1K09X3NDBE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1K09X3NDBE', { 'anonymize_ip': false});
</script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(77706580, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img alt="" src="https://mc.yandex.ru/watch/77706580" style="position:absolute; left:-9999px;"/></div></noscript>
<!-- /Yandex.Metrika counter -->
<script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript">
</script>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
       processEscapes: true
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
   });
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</body>
</html>
